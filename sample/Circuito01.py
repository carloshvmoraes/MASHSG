import pandapower as pp
from pandapower.plotting import simple_plot

print('=== Circuito Exemplo 01 ===')

#Criando rede
net = pp.create_empty_network()

#barras
pp.create_bus(net, 13.8, name='SE-A-01',geodata=(628,125))
pp.create_bus(net, 13.8, name='s1a',geodata=(620,125))
pp.create_bus(net, 13.8, name='s1b',geodata=(544,125))
pp.create_bus(net, 13.8, name='',geodata=(425,125))
pp.create_bus(net, 13.8, name='s2a',geodata=(310,125))
pp.create_bus(net, 13.8, name='s2b',geodata=(237,125))
pp.create_bus(net, 13.8, name='',geodata=(125,125))
pp.create_bus(net, 13.8, name='s3a',geodata=(125,240))
pp.create_bus(net, 13.8, name='s3b',geodata=(125,325))
pp.create_bus(net, 13.8, name='',geodata=(125,450))
pp.create_bus(net, 13.8, name='s4a',geodata=(240,450))
pp.create_bus(net, 13.8, name='s4b',geodata=(320,450))
pp.create_bus(net, 13.8, name='ignora',geodata=(440,450))
pp.create_bus(net, 13.8, name='',geodata=(545,450)) #conexao
pp.create_bus(net, 13.8, name='ignora',geodata=(545,335))
pp.create_bus(net, 13.8, name='s16a',geodata=(680,335))
pp.create_bus(net, 13.8, name='s16b',geodata=(770,335))
pp.create_bus(net, 13.8, name='',geodata=(900,335))
pp.create_bus(net, 13.8, name='ignora',geodata=(545,500))
pp.create_bus(net, 13.8, name='s14a',geodata=(545,570))
pp.create_bus(net, 13.8, name='s14b',geodata=(545,650))
pp.create_bus(net, 13.8, name='',geodata=(545,700))
pp.create_bus(net, 13.8, name='s15a',geodata=(545,730))
pp.create_bus(net, 13.8, name='s15b',geodata=(545,815))
pp.create_bus(net, 13.8, name='',geodata=(545,985))
pp.create_bus(net, 13.8, name='s12a',geodata=(465,985))
pp.create_bus(net, 13.8, name='s12b',geodata=(385,985))
pp.create_bus(net, 13.8, name='',geodata=(330,985))
pp.create_bus(net, 13.8, name='s11a',geodata=(280,985))
pp.create_bus(net, 13.8, name='s11b',geodata=(205,985))
pp.create_bus(net, 13.8, name='',geodata=(120,985))
pp.create_bus(net, 13.8, name='s10a',geodata=(120,850))
pp.create_bus(net, 13.8, name='s10b',geodata=(120,765))
pp.create_bus(net, 13.8, name='SE-B-01',geodata=(120,680))
pp.create_bus(net, 13.8, name='ignora',geodata=(660,450))
pp.create_bus(net, 13.8, name='s13a',geodata=(800,450))
pp.create_bus(net, 13.8, name='s13b',geodata=(870,450))
pp.create_bus(net, 13.8, name='ignora',geodata=(915,450))
pp.create_bus(net, 13.8, name='',geodata=(950,450)) #conexao
pp.create_bus(net, 13.8, name='ignora',geodata=(1000,450))
pp.create_bus(net, 13.8, name='s5a',geodata=(1070,450))
pp.create_bus(net, 13.8, name='s5b',geodata=(1150,450))
pp.create_bus(net, 13.8, name='',geodata=(1210,450))
pp.create_bus(net, 13.8, name='s6a',geodata=(1310,450))
pp.create_bus(net, 13.8, name='s6b',geodata=(1380,450))
pp.create_bus(net, 13.8, name='',geodata=(1460,450))
pp.create_bus(net, 13.8, name='s7a',geodata=(1560,450))
pp.create_bus(net, 13.8, name='s7b',geodata=(1640,450))
pp.create_bus(net, 13.8, name='',geodata=(1740,450))
pp.create_bus(net, 13.8, name='s8a',geodata=(1740,330))
pp.create_bus(net, 13.8, name='s8b',geodata=(1740,250))
pp.create_bus(net, 13.8, name='',geodata=(1740,130))
pp.create_bus(net, 13.8, name='s9a',geodata=(1310,130))
pp.create_bus(net, 13.8, name='s9b',geodata=(1220,130))
pp.create_bus(net, 13.8, name='SE-A-02',geodata=(1140,130))
pp.create_bus(net, 13.8, name='ignora',geodata=(950,510))
pp.create_bus(net, 13.8, name='s17a',geodata=(950,570))
pp.create_bus(net, 13.8, name='s17b',geodata=(950,650))
pp.create_bus(net, 13.8, name='',geodata=(950,860))
pp.create_bus(net, 13.8, name='s18a',geodata=(1190,860))
pp.create_bus(net, 13.8, name='s18b',geodata=(1260,860))
pp.create_bus(net, 13.8, name='',geodata=(1440,860))
pp.create_bus(net, 13.8, name='s19a',geodata=(1640,860))
pp.create_bus(net, 13.8, name='s19b',geodata=(1720,860))
pp.create_bus(net, 13.8, name='SE-C-01',geodata=(1780,860))
#Subestações
pp.create_ext_grid(net, bus=0, vm_pu=1.05, name="SE-A-01")
pp.create_ext_grid(net, bus=64, vm_pu=1.05, name="SE-A-02")
pp.create_ext_grid(net, bus=33, vm_pu=1.05, name="SE-B-01")
pp.create_ext_grid(net, bus=54, vm_pu=1.05, name="SE-C-01")
#Cargas
buses = net.bus.loc[net.bus['name']==''].index
pp.create_loads(net,buses,p_mw=0.04,q_mvar=0.004)
#linhas

pp.create_line(net, from_bus=30, to_bus=31, length_km= 1.0, std_type='15-AL1/3-ST1A 0.4', geodata=((120,985),(120,850)))
pp.create_line(net, from_bus=32, to_bus=33, length_km= 1.0, std_type='15-AL1/3-ST1A 0.4', geodata=((120,765),(120,680)))
pp.create_line(net, from_bus=6, to_bus=7, length_km= 1.0, std_type='15-AL1/3-ST1A 0.4', geodata=((125,125),(125,240)))
pp.create_line(net, from_bus=8, to_bus=9, length_km= 1.0, std_type='15-AL1/3-ST1A 0.4', geodata=((125,325),(125,450)))
pp.create_line(net, from_bus=9, to_bus=10, length_km= 1.0, std_type='15-AL1/3-ST1A 0.4', geodata=((125,450),(240,450)))
pp.create_line(net, from_bus=29, to_bus=30, length_km= 1.0, std_type='15-AL1/3-ST1A 0.4', geodata=((205,985),(120,985)))
pp.create_line(net, from_bus=5, to_bus=6, length_km= 1.0, std_type='15-AL1/3-ST1A 0.4', geodata=((237,125),(125,125)))
pp.create_line(net, from_bus=11, to_bus=12, length_km= 1.0, std_type='15-AL1/3-ST1A 0.4', geodata=((320,450),(440,450)))
pp.create_line(net, from_bus=27, to_bus=28, length_km= 1.0, std_type='15-AL1/3-ST1A 0.4', geodata=((330,985),(280,985)))
pp.create_line(net, from_bus=26, to_bus=27, length_km= 1.0, std_type='15-AL1/3-ST1A 0.4', geodata=((385,985),(330,985)))
pp.create_line(net, from_bus=3, to_bus=4, length_km= 1.0, std_type='15-AL1/3-ST1A 0.4', geodata=((425,125),(310,125)))
pp.create_line(net, from_bus=12, to_bus=13, length_km= 1.0, std_type='15-AL1/3-ST1A 0.4', geodata=((440,450),(545,450)))
pp.create_line(net, from_bus=2, to_bus=3, length_km= 1.0, std_type='15-AL1/3-ST1A 0.4', geodata=((544,125),(425,125)))
pp.create_line(net, from_bus=13, to_bus=14, length_km= 1.0, std_type='15-AL1/3-ST1A 0.4', geodata=((545,450),(545,335)))
pp.create_line(net, from_bus=13, to_bus=34, length_km= 1.0, std_type='15-AL1/3-ST1A 0.4', geodata=((545,450),(660,450)))
pp.create_line(net, from_bus=14, to_bus=15, length_km= 1.0, std_type='15-AL1/3-ST1A 0.4', geodata=((545,335),(680,335)))
pp.create_line(net, from_bus=13, to_bus=18, length_km= 1.0, std_type='15-AL1/3-ST1A 0.4', geodata=((545,450),(545,500)))
pp.create_line(net, from_bus=18, to_bus=19, length_km= 1.0, std_type='15-AL1/3-ST1A 0.4', geodata=((545,500),(545,570)))
pp.create_line(net, from_bus=20, to_bus=21, length_km= 1.0, std_type='15-AL1/3-ST1A 0.4', geodata=((545,650),(545,700)))
pp.create_line(net, from_bus=21, to_bus=22, length_km= 1.0, std_type='15-AL1/3-ST1A 0.4', geodata=((545,700),(545,730)))
pp.create_line(net, from_bus=23, to_bus=24, length_km= 1.0, std_type='15-AL1/3-ST1A 0.4', geodata=((545,815),(545,985)))
pp.create_line(net, from_bus=24, to_bus=25, length_km= 1.0, std_type='15-AL1/3-ST1A 0.4', geodata=((545,985),(465,985)))
pp.create_line(net, from_bus=0, to_bus=1, length_km= 1.0, std_type='15-AL1/3-ST1A 0.4', geodata=((628,125),(620,125)))
pp.create_line(net, from_bus=34, to_bus=35, length_km= 1.0, std_type='15-AL1/3-ST1A 0.4', geodata=((660,450),(800,450)))
pp.create_line(net, from_bus=16, to_bus=17, length_km= 1.0, std_type='15-AL1/3-ST1A 0.4', geodata=((770,335),(900,335)))
pp.create_line(net, from_bus=36, to_bus=37, length_km= 1.0, std_type='15-AL1/3-ST1A 0.4', geodata=((870,450),(915,450)))
pp.create_line(net, from_bus=37, to_bus=38, length_km= 1.0, std_type='15-AL1/3-ST1A 0.4', geodata=((915,450),(950,450)))
pp.create_line(net, from_bus=38, to_bus=39, length_km= 1.0, std_type='15-AL1/3-ST1A 0.4', geodata=((950,450),(1000,450)))
pp.create_line(net, from_bus=38, to_bus=55, length_km= 1.0, std_type='15-AL1/3-ST1A 0.4', geodata=((950,450),(950,510)))
pp.create_line(net, from_bus=55, to_bus=56, length_km= 1.0, std_type='15-AL1/3-ST1A 0.4', geodata=((950,510),(950,570)))
pp.create_line(net, from_bus=57, to_bus=58, length_km= 1.0, std_type='15-AL1/3-ST1A 0.4', geodata=((950,650),(950,860)))
pp.create_line(net, from_bus=58, to_bus=59, length_km= 1.0, std_type='15-AL1/3-ST1A 0.4', geodata=((950,860),(1190,860)))
pp.create_line(net, from_bus=39, to_bus=40, length_km= 1.0, std_type='15-AL1/3-ST1A 0.4', geodata=((1000,450),(1070,450)))
pp.create_line(net, from_bus=41, to_bus=42, length_km= 1.0, std_type='15-AL1/3-ST1A 0.4', geodata=((1150,450),(1210,450)))
pp.create_line(net, from_bus=42, to_bus=43, length_km= 1.0, std_type='15-AL1/3-ST1A 0.4', geodata=((1210,450),(1310,450)))
pp.create_line(net, from_bus=53, to_bus=54, length_km= 1.0, std_type='15-AL1/3-ST1A 0.4', geodata=((1220,130),(1140,130)))
pp.create_line(net, from_bus=60, to_bus=61, length_km= 1.0, std_type='15-AL1/3-ST1A 0.4', geodata=((1260,860),(1440,860)))
pp.create_line(net, from_bus=44, to_bus=45, length_km= 1.0, std_type='15-AL1/3-ST1A 0.4', geodata=((1380,450),(1460,450)))
pp.create_line(net, from_bus=61, to_bus=62, length_km= 1.0, std_type='15-AL1/3-ST1A 0.4', geodata=((1440,860),(1640,860)))
pp.create_line(net, from_bus=45, to_bus=46, length_km= 1.0, std_type='15-AL1/3-ST1A 0.4', geodata=((1460,450),(1560,450)))
pp.create_line(net, from_bus=47, to_bus=48, length_km= 1.0, std_type='15-AL1/3-ST1A 0.4', geodata=((1640,450),(1740,450)))
pp.create_line(net, from_bus=63, to_bus=64, length_km= 1.0, std_type='15-AL1/3-ST1A 0.4', geodata=((1720,860),(1780,860)))
pp.create_line(net, from_bus=48, to_bus=49, length_km= 1.0, std_type='15-AL1/3-ST1A 0.4', geodata=((1740,450),(1740,330)))
pp.create_line(net, from_bus=50, to_bus=51, length_km= 1.0, std_type='15-AL1/3-ST1A 0.4', geodata=((1740,250),(1740,130)))
pp.create_line(net, from_bus=51, to_bus=52, length_km= 1.0, std_type='15-AL1/3-ST1A 0.4', geodata=((1740,130),(1310,130)))
# linhas das chaves
pp.create_line(net, from_bus=1, to_bus=2, index=45, length_km= 0.01, std_type='15-AL1/3-ST1A 0.4', geodata=((620,125),(544,125)))
pp.create_line(net, from_bus=4, to_bus=5, index=46, length_km= 0.01, std_type='15-AL1/3-ST1A 0.4', geodata=((310,125),(237,125)))
pp.create_line(net, from_bus=7, to_bus=8, index=47, length_km= 0.01, std_type='15-AL1/3-ST1A 0.4', geodata=((125,240),(125,325)))
pp.create_line(net, from_bus=10, to_bus=11, index=48, length_km= 0.01, std_type='15-AL1/3-ST1A 0.4', geodata=((240,450),(320,450)))
pp.create_line(net, from_bus=15, to_bus=16, index=49, length_km= 0.01, std_type='15-AL1/3-ST1A 0.4', geodata=((680,335),(770,335)))
pp.create_line(net, from_bus=19, to_bus=20, index=50, length_km= 0.01, std_type='15-AL1/3-ST1A 0.4', geodata=((545,570),(545,650)))
pp.create_line(net, from_bus=22, to_bus=23, index=51, length_km= 0.01, std_type='15-AL1/3-ST1A 0.4', geodata=((545,730),(545,815)))
pp.create_line(net, from_bus=25, to_bus=26, index=52, length_km= 0.01, std_type='15-AL1/3-ST1A 0.4', geodata=((465,985),(385,985)))
pp.create_line(net, from_bus=28, to_bus=29, index=53, length_km= 0.01, std_type='15-AL1/3-ST1A 0.4', geodata=((280,985),(205,985)))
pp.create_line(net, from_bus=31, to_bus=32, index=54, length_km= 0.01, std_type='15-AL1/3-ST1A 0.4', geodata=((120,850),(120,765)))
pp.create_line(net, from_bus=35, to_bus=36, index=55, length_km= 0.01, std_type='15-AL1/3-ST1A 0.4', geodata=((800,450),(870,450)))
pp.create_line(net, from_bus=40, to_bus=41, index=56, length_km= 0.01, std_type='15-AL1/3-ST1A 0.4', geodata=((1070,450),(1150,450)))
pp.create_line(net, from_bus=43, to_bus=44, index=57, length_km= 0.01, std_type='15-AL1/3-ST1A 0.4', geodata=((1310,450),(1380,450)))
pp.create_line(net, from_bus=46, to_bus=47, index=58, length_km= 0.01, std_type='15-AL1/3-ST1A 0.4', geodata=((1560,450),(1640,450)))
pp.create_line(net, from_bus=49, to_bus=50, index=59, length_km= 0.01, std_type='15-AL1/3-ST1A 0.4', geodata=((1740,330),(1740,250)))
pp.create_line(net, from_bus=52, to_bus=53, index=60, length_km= 0.01, std_type='15-AL1/3-ST1A 0.4', geodata=((1310,130),(1220,130)))
pp.create_line(net, from_bus=56, to_bus=57, index=61, length_km= 0.01, std_type='15-AL1/3-ST1A 0.4', geodata=((950,570),(950,650)))
pp.create_line(net, from_bus=59, to_bus=60, index=62, length_km= 0.01, std_type='15-AL1/3-ST1A 0.4', geodata=((1190,860),(1260,860)))
pp.create_line(net, from_bus=62, to_bus=63, index=63, length_km= 0.01, std_type='15-AL1/3-ST1A 0.4', geodata=((1640,860),(1720,860)))

# criando uma chave por linha
pp.create_switch(net,bus=1, element=45,et='l', closed=True, type='CB', name='S1')
pp.create_switch(net,bus=4, element=46,et='l', closed=True, type='LBS', name='S2')
pp.create_switch(net,bus=7, element=47,et='l', closed=True, type='LBS', name='S3')
pp.create_switch(net,bus=10, element=48,et='l', closed=True, type='LBS', name='S4')
pp.create_switch(net,bus=40, element=56,et='l', closed=False, type='LBS', name='S5')
pp.create_switch(net,bus=43, element=57,et='l', closed=True, type='LBS', name='S6')
pp.create_switch(net,bus=46, element=58,et='l', closed=True, type='LBS', name='S7')
pp.create_switch(net,bus=49, element=59,et='l', closed=True, type='LBS', name='S8')
pp.create_switch(net,bus=52, element=60,et='l', closed=True, type='CB', name='S9')
pp.create_switch(net,bus=31, element=54,et='l', closed=True, type='CB', name='S10')
pp.create_switch(net,bus=28, element=53,et='l', closed=True, type='LBS', name='S11')
pp.create_switch(net,bus=25, element=52,et='l', closed=False, type='LBS', name='S12')
pp.create_switch(net,bus=35, element=55,et='l', closed=True, type='LBS', name='S13')
pp.create_switch(net,bus=19, element=50,et='l', closed=True, type='LBS', name='S14')
pp.create_switch(net,bus=22, element=51,et='l', closed=True, type='LBS', name='S15')
pp.create_switch(net,bus=15, element=49,et='l', closed=True, type='LBS', name='S16')
pp.create_switch(net,bus=56, element=61,et='l', closed=False, type='LBS', name='S17')
pp.create_switch(net,bus=59, element=62,et='l', closed=True, type='LBS', name='S18')
pp.create_switch(net,bus=62, element=63,et='l', closed=True, type='CB', name='S19')

#simple_plot(net,bus_size=0.3, plot_loads=True, plot_line_switches=True)

pp.to_json(net, 'Circuito01.json')
pp.to_sqlite(net, 'circuito01.sqlite3')